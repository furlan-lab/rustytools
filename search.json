[{"path":"https://furlan-lab.github.io/rustytools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Scott N Furlan Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"installing-rust","dir":"Articles","previous_headings":"","what":"Installing Rust","title":"How to extract coordinates and sequence from a fasta file","text":"First need updated Rust installation. Go site learn install Rust.","code":""},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"installing-rustytools","dir":"Articles","previous_headings":"","what":"Installing rustytools","title":"How to extract coordinates and sequence from a fasta file","text":"need devtools package installed…","code":"devtools::install_github(\"furlan-lab/rustytools\", force=T)"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"running-a-tool-to-extract-consensus-sequence-data","dir":"Articles","previous_headings":"","what":"Running a tool to extract consensus sequence data","title":"How to extract coordinates and sequence from a fasta file","text":"Loading libraries","code":"rm(list=ls()) suppressPackageStartupMessages({   library(rustytools) })"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"get-consensus-from-fasta","dir":"Articles","previous_headings":"","what":"Get consensus from fasta","title":"How to extract coordinates and sequence from a fasta file","text":"function process fasta file processed using tool samtools consensus. function find regions (subsequences) fasta sequence (, C, T, G) output granges object containing features sequences. invoked follows: toy example use cores argument set 1. get_consensus works splitting work contig (chromosome) across cores. example, doesn’t make sense split contigs across cores contig 500-600 bases. running real fasta sequence large genome, one want leverage parallel processing process contig using core. next block show run get_consensus big fasta. running full fasta contigs, can check first n contigs full sized fasta using argument test_with_n. Note full fasta read memory ensure appropriate seqinfo data","code":"root<-file.path(.libPaths()[1], \"rustytools/extdata\") tfasta=file.path(root, \"test.fa\") results<-get_consensus(tfasta, cores=1, genome=\"toy\") results[[1]] ## GRanges object with 7 ranges and 1 metadata column: ##       seqnames    ranges strand | mcols.sequence ##          <Rle> <IRanges>  <Rle> |    <character> ##   [1]     chr1   238-251      * | ACTGACCTTAAGGT ##   [2]    chr12   102-115      * | ACTGACCTTAAGGT ##   [3]    chr12   595-608      * | ACTGACCTTAAGGT ##   [4]     chr3   317-330      * | ACTGACCTTAAGGT ##   [5]     chr4   168-181      * | ACTGACCTTAAGGT ##   [6]     chr5   171-184      * | ACTGACCTTAAGGT ##   [7]     chr6    97-110      * | ACTGACCTTAAGGT ##   ------- ##   seqinfo: 7 sequences from toy genome fasta=\"~/Desktop/GENDX_HLA_Mix1_S1_L001_t1000.fa\" results<-get_consensus(fasta, cores=16, genome=\"hg38\") results<-get_consensus(fasta, cores=16, genome=\"hg38\", test_with_n = 1)"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"merge","dir":"Articles","previous_headings":"","what":"Merge","title":"How to extract coordinates and sequence from a fasta file","text":"","code":"library(GenomicRanges) reduced_results<-reduce(results[[1]], min.gapwidth = 2L)"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"annotation-1","dir":"Articles","previous_headings":"","what":"Annotation 1","title":"How to extract coordinates and sequence from a fasta file","text":"","code":"library(TxDb.Hsapiens.UCSC.hg38.knownGene) library(VariantAnnotation) txdb_hg38 <- TxDb.Hsapiens.UCSC.hg38.knownGene si<-seqinfo(txdb_hg38) reduced_results@seqinfo<-GenomeInfoDb::Seqinfo(seqnames = si@seqnames[1:22], seqlengths = si@seqlengths[1:22], isCircular = rep(NA, 22), genome = \"hg38\") annotated_results <- locateVariants(reduced_results, txdb_hg38, AllVariants()) table(annotated_results$LOCATION) ##  ## spliceSite     intron    fiveUTR   threeUTR     coding intergenic   promoter  ##        441     102441        181        810        978       8991       4487 annotated_results[annotated_results$LOCATION==\"coding\"] ## GRanges object with 978 ranges and 9 metadata columns: ##         seqnames            ranges strand | LOCATION  LOCSTART    LOCEND ##            <Rle>         <IRanges>  <Rle> | <factor> <integer> <integer> ##     [1]     chr1 10639562-10639580      - |   coding      4642      4660 ##     [2]     chr1 11027568-11027586      - |   coding      1162      1180 ##     [3]     chr1 11027568-11027586      - |   coding      1339      1357 ##     [4]     chr1 11027568-11027586      - |   coding      1336      1354 ##     [5]     chr1 11027568-11027586      - |   coding      1360      1378 ##     ...      ...               ...    ... .      ...       ...       ... ##   [974]    chr22 29991526-29991544      + |   coding       316       334 ##   [975]    chr22 29991526-29991544      + |   coding       316       334 ##   [976]    chr22 29991526-29991544      + |   coding       316       334 ##   [977]    chr22 37710509-37710527      + |   coding       197       215 ##   [978]    chr22 37710509-37710527      + |   coding       197       215 ##           QUERYID        TXID         CDSID      GENEID       PRECEDEID ##         <integer> <character> <IntegerList> <character> <CharacterList> ##     [1]        90       12547         14823       54897                 ##     [2]        96       12565         14864       10747                 ##     [3]        96       12566         14864       10747                 ##     [4]        96       12567         14864       10747                 ##     [5]        96       12571         14864       10747                 ##     ...       ...         ...           ...         ...             ... ##   [974]     22248      239650 263516,263515        8897                 ##   [975]     22248      239652 263516,263515        8897                 ##   [976]     22248      239654 263516,263515        8897                 ##   [977]     22310      240233        264135       11078                 ##   [978]     22310      240235        264135       11078                 ##                FOLLOWID ##         <CharacterList> ##     [1]                 ##     [2]                 ##     [3]                 ##     [4]                 ##     [5]                 ##     ...             ... ##   [974]                 ##   [975]                 ##   [976]                 ##   [977]                 ##   [978]                 ##   ------- ##   seqinfo: 22 sequences from hg38 genome"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"annotation-2","dir":"Articles","previous_headings":"","what":"Annotation 2","title":"How to extract coordinates and sequence from a fasta file","text":"","code":"# devtools::install_github(\"Bioconductor/UCSC.utils\") # devtools::install_github(\"Bioconductor/GenomeInfoDb\") # devtools::install_github(\"grimbough/biomaRt\") # devtools::install_github(\"Bioconductor/txdbmaker\") # BiocManager::install(\"EnsDb.Hsapiens.v86\")  library(txdbmaker) gtf_file<-\"/Users/sfurlan/Library/CloudStorage/OneDrive-SharedLibraries-FredHutchinsonCancerCenter/Furlan_Lab - General/resources/refs/gencode.v46.annotation.gtf.gz\" txdb <- makeTxDbFromGFF(gtf_file, format=\"gtf\", dbxrefTag = \"gene_name\") annotated_results2 <- locateVariants(reduced_results, txdb, AllVariants()) annotated_results2 ## GRanges object with 120299 ranges and 9 metadata columns: ##            seqnames            ranges strand | LOCATION  LOCSTART    LOCEND ##               <Rle>         <IRanges>  <Rle> | <factor> <integer> <integer> ##        [1]     chr1     832502-832521      - |   intron      8576      8595 ##        [2]     chr1     832502-832521      - |   intron      8023      8042 ##        [3]     chr1     832502-832521      - |   intron      7470      7489 ##        [4]     chr1     832502-832521      - |   intron     29775     29794 ##        [5]     chr1     832502-832521      - |   intron      6950      6969 ##        ...      ...               ...    ... .      ...       ...       ... ##   [120295]    chr22 40018446-40018463      + |   intron     24286     24303 ##   [120296]    chr22 40018446-40018463      + |   intron     45916     45933 ##   [120297]    chr22 40018446-40018463      + |   intron     22915     22932 ##   [120298]    chr22 40018446-40018463      + |   intron     11525     11542 ##   [120299]    chr22 40018446-40018463      + |   intron      8322      8339 ##              QUERYID        TXID         CDSID             GENEID ##            <integer> <character> <IntegerList>        <character> ##        [1]         1      227999               ENSG00000167384.11 ##        [2]         1      228000               ENSG00000167384.11 ##        [3]         1      228001               ENSG00000167384.11 ##        [4]         1      228001               ENSG00000167384.11 ##        [5]         1      228002               ENSG00000167384.11 ##        ...       ...         ...           ...                ... ##   [120295]     22329      217276               ENSG00000127616.22 ##   [120296]     22329      217276               ENSG00000127616.22 ##   [120297]     22329      217277               ENSG00000127616.22 ##   [120298]     22329      217278               ENSG00000127616.22 ##   [120299]     22329      217279               ENSG00000127616.22 ##                  PRECEDEID        FOLLOWID ##            <CharacterList> <CharacterList> ##        [1]                                 ##        [2]                                 ##        [3]                                 ##        [4]                                 ##        [5]                                 ##        ...             ...             ... ##   [120295]                                 ##   [120296]                                 ##   [120297]                                 ##   [120298]                                 ##   [120299]                                 ##   ------- ##   seqinfo: 22 sequences from hg38 genome"},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"annotation-3","dir":"Articles","previous_headings":"Annotation 2","what":"Annotation 3","title":"How to extract coordinates and sequence from a fasta file","text":"","code":"library(ChIPpeakAnno) library(ensembldb) library(EnsDb.Hsapiens.v86) annoGR <- toGRanges(EnsDb.Hsapiens.v86) seqlevelsStyle(reduced_results) <- seqlevelsStyle(annoGR) annotated_results3<-annoPeaks(reduced_results, annoGR, bindingType = \"fullRange\") annotated_results3[grepl(\"^HLA\", annotated_results3$gene_name)]$gene_name ##  [1] \"HLA-F-AS1\" \"HLA-G\"     \"HLA-L\"     \"HLA-L\"     \"HLA-DRB9\"  \"HLA-DRB9\"  ##  [7] \"HLA-DRB9\"  \"HLA-DRB9\"  \"HLA-DRB9\"  \"HLA-DRB6\"  \"HLA-DRB1\"  \"HLA-DRB6\"  ## [13] \"HLA-DRB1\"  \"HLA-Z\"     \"HLA-Z\"     \"HLA-DOA\"   \"HLA-DPA1\"  \"HLA-DPA3\""},{"path":"https://furlan-lab.github.io/rustytools/articles/getConsensus.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"How to extract coordinates and sequence from a fasta file","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Ventura 13.6.7 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] EnsDb.Hsapiens.v86_2.99.0                ##  [2] ensembldb_2.24.1                         ##  [3] AnnotationFilter_1.24.0                  ##  [4] ChIPpeakAnno_3.34.1                      ##  [5] txdbmaker_1.1.0                          ##  [6] VariantAnnotation_1.46.0                 ##  [7] Rsamtools_2.16.0                         ##  [8] Biostrings_2.68.1                        ##  [9] XVector_0.40.0                           ## [10] SummarizedExperiment_1.30.2              ## [11] MatrixGenerics_1.12.3                    ## [12] matrixStats_1.2.0                        ## [13] TxDb.Hsapiens.UCSC.hg38.knownGene_3.17.0 ## [14] GenomicFeatures_1.52.2                   ## [15] AnnotationDbi_1.62.2                     ## [16] Biobase_2.60.0                           ## [17] GenomicRanges_1.52.1                     ## [18] GenomeInfoDb_1.41.1                      ## [19] IRanges_2.34.1                           ## [20] S4Vectors_0.38.2                         ## [21] BiocGenerics_0.46.0                      ## [22] rustytools_0.0.0.9000                    ##  ## loaded via a namespace (and not attached): ##   [1] rstudioapi_0.15.0        jsonlite_1.8.8           magrittr_2.0.3           ##   [4] rmarkdown_2.26           fs_1.6.3                 BiocIO_1.10.0            ##   [7] zlibbioc_1.46.0          ragg_1.3.0               vctrs_0.6.5              ##  [10] multtest_2.56.0          memoise_2.0.1            RCurl_1.98-1.14          ##  [13] htmltools_0.5.7          S4Arrays_1.2.0           progress_1.2.3           ##  [16] lambda.r_1.2.4           curl_5.2.1               sass_0.4.9               ##  [19] bslib_0.6.1              desc_1.4.3               httr2_1.0.0              ##  [22] futile.options_1.0.1     cachem_1.0.8             GenomicAlignments_1.36.0 ##  [25] lifecycle_1.0.4          pkgconfig_2.0.3          Matrix_1.6-5             ##  [28] R6_2.5.1                 fastmap_1.1.1            GenomeInfoDbData_1.2.10  ##  [31] digest_0.6.35            colorspace_2.1-0         regioneR_1.32.0          ##  [34] textshaping_0.3.7        RSQLite_2.3.5            filelock_1.0.3           ##  [37] fansi_1.0.6              httr_1.4.7               abind_1.4-5              ##  [40] compiler_4.3.1           bit64_4.0.5              BiocParallel_1.34.2      ##  [43] DBI_1.2.1                biomaRt_2.61.0           MASS_7.3-60.0.1          ##  [46] rappdirs_0.3.3           DelayedArray_0.26.7      rjson_0.2.21             ##  [49] tools_4.3.1              glue_1.7.0               VennDiagram_1.7.3        ##  [52] restfulr_0.0.15          InteractionSet_1.28.1    grid_4.3.1               ##  [55] ade4_1.7-22              generics_0.1.3           seqinr_4.2-36            ##  [58] gtable_0.3.4             BSgenome_1.68.0          hms_1.1.3                ##  [61] xml2_1.3.6               utf8_1.2.4               pillar_1.9.0             ##  [64] stringr_1.5.1            splines_4.3.1            dplyr_1.1.4              ##  [67] BiocFileCache_2.8.0      lattice_0.22-5           survival_3.5-7           ##  [70] rtracklayer_1.60.1       bit_4.0.5                tidyselect_1.2.1         ##  [73] RBGL_1.76.0              knitr_1.45               ProtGenerics_1.32.0      ##  [76] futile.logger_1.4.3      xfun_0.42                stringi_1.8.3            ##  [79] UCSC.utils_1.1.0         lazyeval_0.2.2           yaml_2.3.8               ##  [82] evaluate_0.23            codetools_0.2-19         tibble_3.2.1             ##  [85] graph_1.78.0             cli_3.6.2                pbmcapply_1.5.1          ##  [88] systemfonts_1.0.6        munsell_0.5.0            jquerylib_0.1.4          ##  [91] Rcpp_1.0.12              dbplyr_2.3.4             png_0.1-8                ##  [94] XML_3.99-0.16.1          parallel_4.3.1           pkgdown_2.0.7            ##  [97] ggplot2_3.5.0            blob_1.2.4               prettyunits_1.2.0        ## [100] bitops_1.0-7             scales_1.3.0             purrr_1.0.2              ## [103] crayon_1.5.2             rlang_1.1.3              KEGGREST_1.40.1          ## [106] formatR_1.14"},{"path":"https://furlan-lab.github.io/rustytools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Scott Furlan. Author, maintainer.","code":""},{"path":"https://furlan-lab.github.io/rustytools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Furlan S (2024). rustytools: package brings several rust tools R environment. R package version 0.0.0.9000, https://furlan-lab.github.io/rustytools/.","code":"@Manual{,   title = {rustytools: This package brings several rust tools to the R environment},   author = {Scott Furlan},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://furlan-lab.github.io/rustytools/}, }"},{"path":"https://furlan-lab.github.io/rustytools/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"This package brings several rust tools to the R environment","text":"First need updated Rust installation. Go site learn install Rust. install rustytools:","code":"remotes::install_github(\"furlan-lab/rustytools\")"},{"path":"https://furlan-lab.github.io/rustytools/index.html","id":"how-to-start","dir":"","previous_headings":"","what":"How to start","title":"This package brings several rust tools to the R environment","text":"vignette one function… vignette(\"getConsensus\") explore bountiful package.","code":""},{"path":"https://furlan-lab.github.io/rustytools/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"This package brings several rust tools to the R environment","text":"MIT license.","code":""},{"path":"https://furlan-lab.github.io/rustytools/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"This package brings several rust tools to the R environment","text":"Written Scott Furlan.","code":""},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Consensus Sequences from a FASTA File — get_consensus","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"function reads DNA FASTA file, processes sequences, returns consensus sequences GRangesList. function can optionally use multiple cores parallel processing.","code":""},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"","code":"get_consensus(fasta, cores = 1, genome = \"hg38\", test_with_n = NULL)"},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"fasta string specifying path input FASTA file. cores integer specifying number cores use parallel processing. Default 1. genome string specifying genome build. Default \"hg38\". test_with_n optional integer specifying number sequences process testing. NULL, sequences processed. Default NULL.","code":""},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"GRangesList containing consensus sequences coordinates sequence information.","code":""},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"documentation written ChatGPT v4o - OpenAI, conversation author, 6-5-2024.","code":""},{"path":"https://furlan-lab.github.io/rustytools/reference/get_consensus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Consensus Sequences from a FASTA File — get_consensus","text":"","code":"if (FALSE) { consensus <- get_consensus(\"path/to/fasta/file.fasta\", cores=2, genome=\"hg19\") }"},{"path":"https://furlan-lab.github.io/rustytools/reference/rustytools-package.html","id":null,"dir":"Reference","previous_headings":"","what":"rustytools: This package brings several rust tools to the R environment — rustytools-package","title":"rustytools: This package brings several rust tools to the R environment — rustytools-package","text":"complicated","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/rustytools/reference/rustytools-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"rustytools: This package brings several rust tools to the R environment — rustytools-package","text":"Maintainer: Scott Furlan scottfurlan@gmail.com (ORCID)","code":""},{"path":"https://furlan-lab.github.io/rustytools/news/index.html","id":"rustytools-v0009000","dir":"Changelog","previous_headings":"","what":"rustytools v0.0.0.9000","title":"rustytools v0.0.0.9000","text":"first stable version","code":""}]
