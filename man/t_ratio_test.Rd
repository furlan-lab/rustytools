% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pcha.R
\name{t_ratio_test}
\alias{t_ratio_test}
\title{Empirical t-ratio test of PCHA polytopes (Korem et al., 2015)}
\usage{
t_ratio_test(
  X,
  k,
  B = 1000,
  shuffle_fun = function(mat) apply(mat, 1L, sample),
  cores = parallel::detectCores(logical = FALSE),
  ...
)
}
\arguments{
\item{X}{A numeric \eqn{p \times n} matrix
(variables / genes in rows, samples / cells in columns).}

\item{k}{Integer \eqn{\ge 3}. Number of archetypes to test.}

\item{B}{Integer \eqn{\ge 1}. Number of bootstrap / shuffle
repetitions.  Default \code{1000}.}

\item{shuffle_fun}{A function that takes \code{X} and returns a
shuffled version; the default independently permutes every
row, destroying correlations while preserving univariate
distributions.}

\item{cores}{How many parallel workers to use (via
\link[future]{plan}).  Set to \code{1L} to run sequentially.
Default: all physical cores detected.}

\item{...}{Additional arguments passed \strong{unchanged} to
\code{rustytools::\link[rustytools:pcha]{pcha}} â€“ e.g.,
\code{max_iter}, \code{conv_crit}, or custom initialisations.}
}
\value{
A list with components
\describe{
\item{\code{tratio}}{Observed \emph{t}-ratio.}
\item{\code{p_empirical}}{Empirical one-tailed \eqn{p}-value.}
\item{\code{boot_tratios}}{Numeric vector of length \code{B}
with bootstrap statistics (invisibly).}
}
}
\description{
For a fixed number of archetypes \eqn{k}, fits PCHA to the data,
computes the \emph{t}-ratio (ratio between the volume of the archetype
polytope and the convex hull of the data projected to
\eqn{k-1} dimensions), and estimates a one-tailed empirical
\eqn{p}-value by comparing the observed statistic to the
distribution obtained from \code{B} shuffled data sets
(row-wise permutations; see Korem \emph{et al.}, Cell 2015).
}
\examples{
\dontrun{
set.seed(1)
p  <- 60; n <- 300; k0 <- 5
A  <- matrix(rexp(p * k0),  p, k0)
S  <- apply(matrix(rexp(k0 * n), k0, n), 2, `/`, sum)
X  <- A \%*\% S + matrix(rgamma(p * n, 1, 50), p, n)

out <- t_ratio_test(X, k = 5, B = 200, max_iter = 300)
out$tratio
out$p_empirical
}

}
